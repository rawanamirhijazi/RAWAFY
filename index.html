<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAWAFY | ضغط الصور أونلاين مجاناً</title>
    
    <meta name="description" content="قم بضغط صورك وتصغير حجمها مع الحفاظ على الجودة العالية. أداة RAWAFY تدعم ضغط الصور المتعددة وتحميلها بملف واحد. سريعة، آمنة، ومجانية.">
    <meta name="keywords" content="ضغط صور, تصغير حجم الصور, تقليل حجم jpeg, ضغط الصور بدون فقدان الجودة, RAWAFY, تحويل الصور">
    
    <meta property="og:title" content="RAWAFY - ضغط الصور باحترافية">
    <meta property="og:description" content="وفر مساحة جهازك واضغط صورك الآن بضغطة زر واحدة.">
    <meta property="og:image" content="icon-512.png">

    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
    <link rel="apple-touch-icon" href="icon-512.png">
    <meta name="theme-color" content="#7e78f3">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

    <style>
        :root {
            /* الألوان المستخرجة من الأيقونة */
            --primary: #7e78f3; /* البنفسجي الأساسي في الأيقونة */
            --secondary: #4d91ff; /* الأزرق الفاتح في حرف R */
            --accent: #a5a1ff; /* البنفسجي الفاتح للإضاءة */
            --dark-card: rgba(30, 31, 62, 0.8); /* خلفية داكنة مائلة للبنفسجي */
            --bg-color: #0b0d1e; /* خلفية الصفحة العميقة */
            --border-color: #4a4e91; /* لون الحدود المتناسق */
        }

        * { box-sizing: border-box; outline: none; }

        body {
            margin: 0;
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-color);
            color: #e2e8f0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .container {
            max-width: 1000px;
            margin: auto;
            padding: 40px 20px;
            width: 100%;
        }

        .header { text-align: center; margin-bottom: 50px; }
        .header h1 {
            font-size: 3.5rem;
            margin: 0;
            /* تدرج لوني يحاكي تدرج حرف R في الأيقونة */
            background: linear-gradient(135deg, #a5a1ff, #4d91ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 900;
            filter: drop-shadow(0 4px 10px rgba(126, 120, 243, 0.3));
        }

        .quality-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
        }

        .q-btn {
            background: #1a1b3a;
            border: 2px solid var(--border-color);
            color: #94a3b8;
            padding: 10px 25px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: 0.3s;
        }

        .q-btn.active {
            border-color: var(--secondary);
            background: rgba(77, 145, 255, 0.2);
            color: white;
            box-shadow: 0 0 15px rgba(77, 145, 255, 0.3);
        }

        .drop-zone {
            padding: 50px;
            text-align: center;
            border: 2px dashed var(--border-color);
            border-radius: 24px;
            cursor: pointer;
            background: var(--dark-card);
            transition: 0.3s;
            margin-bottom: 40px;
        }

        .drop-zone:hover { 
            border-color: var(--primary); 
            background: rgba(126, 120, 243, 0.1); 
        }

        .results {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 100px;
        }

        .card {
            background: #1a1b3a;
            border-radius: 24px;
            overflow: hidden;
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }

        .preview {
            height: 220px;
            background: #05060f;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            overflow: hidden;
        }

        .preview img { max-width: 100%; max-height: 100%; object-fit: contain; }

        .card-body { padding: 20px; text-align: right; }

        .stats-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .size-tag { font-size: 0.9rem; color: #94a3b8; }
        .size-tag b { color: var(--secondary); }

        .download-btn {
            width: 100%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 14px;
            border-radius: 14px;
            font-weight: bold;
            display: block;
            text-decoration: none;
            text-align: center;
            transition: 0.3s;
        }
        
        .download-btn:hover {
            filter: brightness(1.1);
            transform: translateY(-2px);
        }

        .zip-btn {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary);
            color: white;
            padding: 15px 40px;
            border-radius: 50px;
            box-shadow: 0 10px 25px rgba(126, 120, 243, 0.4);
            display: none;
            z-index: 100;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }

        /* --- قائمة التواصل الاجتماعي --- */
        .social-container {
            position: fixed;
            bottom: 30px;
            right: 30px; /* تم التعديل لليمين ليتناسب مع الاتجاه العربي RTL */
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 2000;
        }

        .social-menu {
            display: flex;
            flex-direction: column;
            gap: 15px;
            background: #1a1b3a;
            padding: 15px;
            border-radius: 20px;
            border: 1px solid var(--border-color);
            margin-bottom: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            transform: translateY(20px) scale(0);
            opacity: 0;
            pointer-events: none;
            transform-origin: bottom center;
        }

        .social-menu.active {
            transform: translateY(0) scale(1);
            opacity: 1;
            pointer-events: auto;
        }

        .social-menu a {
            transition: transform 0.3s;
            display: flex;
            align-items: center;
        }

        .social-menu a:hover { transform: scale(1.2); }

        .social-toggle {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(126, 120, 243, 0.4);
            border: none;
            transition: 0.3s;
        }

        .social-toggle:hover { transform: rotate(90deg); }

        #modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(5, 6, 15, 0.95);
            z-index: 3000;
            padding: 40px;
            justify-content: center;
            align-items: center;
        }
        #modal img { max-width: 100%; max-height: 100%; border-radius: 12px; border: 2px solid var(--primary); }

        #loading { display: none; text-align: center; padding: 20px; color: var(--secondary); font-weight: bold; }
    </style>
</head>
<body>

<div id="modal" onclick="this.style.display='none'">
    <img id="modal-img">
</div>

<div class="container">
    <div class="header">
        <h1>RAWAFY</h1>
        <p>الأداة الأقوى لضغط الصور أونلاين .. جودة عالية وحجم أقل</p>
    </div>

    <div class="quality-selector">
        <button class="q-btn" onclick="setQuality(0.5, this)">ضغط قوي</button>
        <button class="q-btn active" onclick="setQuality(0.8, this)">متوازن</button>
        <button class="q-btn" onclick="setQuality(0.95, this)">جودة كاملة</button>
    </div>

    <div class="drop-zone" onclick="document.getElementById('fileInput').click()">
        <p>اسحب الصور هنا للبدء..</p>
        <input type="file" id="fileInput" multiple accept="image/*" hidden>
    </div>

    <div id="loading">جاري المعالجة...</div>
    <div class="results" id="results"></div>
</div>

<button class="zip-btn" id="zipBtn" onclick="downloadZip()">تحميل الكل في ملف ZIP</button>

<div class="social-container">
    <div class="social-menu" id="socialMenu">
        <a href="https://wa.me/970595297159" target="_blank" title="WhatsApp"><svg fill="#25D366" viewBox="0 0 24 24" width="30"><path d="M12 2a10 10 0 0 0-8.5 15.3L2 22l4.8-1.5A10 10 0 1 0 12 2zm5.5 14.5c-.2.6-1.2 1.2-1.7 1.3-.4.1-.9.2-3-.6-2.4-.9-4-3.3-4.1-3.5-.1-.2-1-1.4-1-2.6 0-1.2.6-1.8.8-2 .2-.2.5-.3.7-.3h.5c.2 0 .4 0 .6.5.2.6.7 2 .8 2.1.1.1.1.3 0 .5-.1.2-.2.3-.3.4-.2.2-.3.3-.5.5-.2.2-.3.3-.1.6.2.3.8 1.3 1.8 2.1 1.2 1 2.2 1.3 2.5 1.5.3.1.5.1.7-.1.2-.2.7-.8.9-1 .2-.2.4-.2.7-.1.3.1 1.8.8 2.1 1 .3.2.5.3.5.5 0 .2 0 1.1-.2 1.7z"/></svg></a>
        <a href="https://t.me/rawanhijazi_0" target="_blank" title="Telegram"><svg fill="#0088cc" viewBox="0 0 24 24" width="30"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69.01-.03.01-.14-.07-.2s-.21-.05-.3-.03c-.12.02-1.96 1.24-5.54 3.65-.52.36-.99.54-1.41.53-.46-.01-1.35-.26-2.01-.48-.81-.27-1.45-.41-1.39-.87.03-.24.38-.49 1.05-.74 4.12-1.79 6.87-2.97 8.24-3.53 3.93-1.62 4.74-1.9 5.27-1.91.12 0 .38.03.55.17.14.12.18.28.2.45-.02.07-.02.15-.03.22z"/></svg></a>
        <a href="https://instagram.com/rawanhijazi2003" target="_blank" title="Instagram"><svg fill="#E4405F" viewBox="0 0 24 24" width="30"><path d="M7 2C4.2 2 2 4.2 2 7v10c0 2.8 2.2 5 5 5h10c2.8 0 5-2.2 5-5V7c0-2.8-2.2-5-5-5H7zm5 5.8A4.2 4.2 0 1 1 7.8 12 4.2 4.2 0 0 1 12 7.8zm4.5-.9a1 1 0 1 1-1 1 1 1 0 0 1 1-1z"/></svg></a>
        <a href="https://www.facebook.com/profile.php?id=100081812613159" target="_blank" title="Facebook"><svg fill="#1877F2" viewBox="0 0 24 24" width="30"><path d="M22 12a10 10 0 1 0-11.6 9.9v-7H8v-3h2.4V9.5c0-2.4 1.4-3.7 3.6-3.7 1 0 2 .2 2 .2v2.3h-1.1c-1.1 0-1.4.7-1.4 1.3V12H17l-.4 3h-2.9v7A10 10 0 0 0 22 12z"/></svg></a>
        <a href="https://www.linkedin.com/in/rawan-hijazi-ab889b368" target="_blank" title="LinkedIn"><svg fill="#0A66C2" viewBox="0 0 24 24" width="30"><path d="M4.98 3.5A2.5 2.5 0 1 0 5 8a2.5 2.5 0 0 0-.02-4.5zM3 9h4v12H3zM9 9h3.6v1.7h.1c.5-.9 1.7-1.9 3.6-1.9 3.8 0 4.5 2.5 4.5 5.7V21h-4v-5.4c0-1.3 0-3-1.8-3s-2.1 1.4-2.1 2.9V21H9z"/></svg></a>
    </div>
    <button class="social-toggle" onclick="toggleSocial()">
        <svg fill="white" viewBox="0 0 24 24" width="32"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4 11h-3v3c0 .55-.45 1-1 1s-1-.45-1-1v-3H8c-.55 0-1-.45-1-1s.45-1 1-1h3V8c0-.55.45-1 1-1s1 .45 1 1v3h3c.55 0 1 .45 1 1s-.45 1-1 1z"/></svg>
    </button>
</div>

<script>
    let currentQuality = 0.8;
    let processedFiles = [];

    function toggleSocial() {
        document.getElementById('socialMenu').classList.toggle('active');
    }

    window.onclick = function(event) {
        if (!event.target.closest('.social-container')) {
            document.getElementById('socialMenu').classList.remove('active');
        }
    }

    function setQuality(q, btn) {
        currentQuality = q;
        document.querySelectorAll('.q-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
    }

    const fileInput = document.getElementById("fileInput");
    fileInput.onchange = async (e) => {
        const files = Array.from(e.target.files);
        if(!files.length) return;

        document.getElementById('loading').style.display = "block";
        document.getElementById('results').innerHTML = "";
        processedFiles = [];

        for (const file of files) {
            const compressed = await processImage(file);
            processedFiles.push(compressed);
            renderCard(compressed);
        }

        document.getElementById('loading').style.display = "none";
        document.getElementById('zipBtn').style.display = processedFiles.length > 1 ? "block" : "none";
    };

    function processImage(file) {
        return new Promise(resolve => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = (e) => {
                const img = new Image();
                img.src = e.target.result;
                img.onload = () => {
                    const canvas = document.createElement("canvas");
                    canvas.width = img.width;
                    canvas.height = img.height;
                    const ctx = canvas.getContext("2d");
                    ctx.drawImage(img, 0, 0);

                    canvas.toBlob(blob => {
                        let ratio = Math.round((1 - blob.size / file.size) * 100);
                        if (ratio < 0) ratio = 0;

                        resolve({
                            name: file.name.replace(/\.[^/.]+$/, "") + ".jpg",
                            oldSize: formatSize(file.size),
                            newSize: formatSize(blob.size),
                            ratio: ratio,
                            url: URL.createObjectURL(blob),
                            blob: blob
                        });
                    }, "image/jpeg", currentQuality);
                };
            };
        });
    }

    function formatSize(bytes) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    function renderCard(data) {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
            <div class="preview" onclick="showModal('${data.url}')">
                <img src="${data.url}">
            </div>
            <div class="card-body">
                <div class="stats-row">
                    <span class="size-tag">قبل: ${data.oldSize}</span>
                    <span class="size-tag">بعد: <b>${data.newSize}</b></span>
                </div>
                <div style="margin-bottom:15px; font-size:0.8rem; color:var(--accent)">
                    تم توفير مساحة بنسبة ${data.ratio}% ✨
                </div>
                <a href="${data.url}" download="RAWAFY_${data.name}" class="download-btn">تحميل الصورة</a>
            </div>
        `;
        document.getElementById('results').appendChild(card);
    }

    function showModal(url) {
        document.getElementById('modal-img').src = url;
        document.getElementById('modal').style.display = 'flex';
    }

    async function downloadZip() {
        const zip = new JSZip();
        processedFiles.forEach(f => zip.file("RAWAFY_" + f.name, f.blob));
        const content = await zip.generateAsync({type:"blob"});
        const link = document.createElement("a");
        link.href = URL.createObjectURL(content);
        link.download = "RAWAFY_Photos.zip";
        link.click();
    }
</script>

</body>
</html>